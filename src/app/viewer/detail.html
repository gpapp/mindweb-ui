<div class="panel panel-primary">
    <div class="panel-heading panel-title" (click)="Ui.turnOff('detailPanel')">
        Hide details <span class="pull-right fa fa-close"></span>
    </div>
    <span ui-turn-off="detailPanel"></span>

    <div class="panel-body">
        <textarea id="contentID" class="tab-pane form-control" rows="5" ng-model="currentEditor.text"
                  ng-if="editable"></textarea>
        <markdown class="tab-pane tab-content" ng-model="currentEditor.text" ng-if="!editable"></markdown>

        <uib-tabset>
            <uib-tab active="selectedTab=='details'" ng-if="editable||currentEditor.detail">
                <tab-heading (click)="selectTab('details')">
                    <i class='fa fa-fw fa-info'></i>Details
                </tab-heading>
                <textarea id="detailsID" class="tab-pane form-control" rows="5"
                          ng-if="editable"
                          ng-model="currentEditor.detail"></textarea>
                <markdown class="tab-pane tab-content" ng-model="currentEditor.detail" ng-if="!editable"></markdown>
            </uib-tab>
            <uib-tab active="selectedTab=='notes'" ng-if="editable||currentEditor.note">
                <tab-heading (click)="selectTab('notes')">
                    Notes
                </tab-heading>
                <textarea id="notesID" class="tab-pane form-control" rows="5"
                          ng-if="editable"
                          ng-model="currentEditor.note"></textarea>
                <markdown class="tab-pane tab-content" ng-model="currentEditor.note" ng-if="!editable"></markdown>
            </uib-tab>
            <uib-tab active="selectedTab=='icons'" ng-if="editable||currentNode.icon">
                <tab-heading (click)="selectTab('icons')">
                    <i class='fa fa-stack fa-picture-o'></i>Icons
                </tab-heading>
                <div class="panel">
                    <div id='detail-icon' class="panel-body ">
                        <div class="icon"
                             ng-repeat="attr in currentNode.icon" (mouseover)="iconEditor=true"
                             (mouseleave)="iconEditor=false">
                            <div ui-state="iconEditor">
                                <img class=" mw-detail-icon" ng-src="/images/icons/{{attr.$['BUILTIN']|escape}}.png"/>
                                <span ng-if="editable">
                                <i class="fa fa-trash" ngClass="{hidden: !iconEditor}"
                                   (click)="deleteIcon($index)"></i>
                                <i class="fa fa-arrow-left" ngClass="{hidden: !iconEditor||$first}"
                                   (click)="moveIcon($index,'left')"></i>
                                <i class="fa fa-arrow-right" ngClass="{hidden: !iconEditor||$last}"
                                   (click)="moveIcon($index,'right')"></i>
                                </span>
                            </div>
                        </div>
                    </div>
                    <div class="panel-footer" ng-if="editable">
                        <i class="fa fa-2x fa-plus-circle pull-right" ui-turn-on="iconDialog"></i>
                    </div>
                </div>
            </uib-tab>
            <uib-tab active="selectedTab=='properties'" ng-if="editable||currentNode.attribute">
                <tab-heading (click)="selectTab('properties')">
                    <i class='fa fa-fw fa-table'></i>Properties
                </tab-heading>

                <table class="table table-bordered">
                    <thead>
                    <tr>
                        <th>Name</th>
                        <th>Value</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr ng-repeat="attr in currentNode.attribute">
                        <td ng-bind="attr.$['NAME']"></td>
                        <td ng-bind="attr.$['VALUE']"></td>
                    </tr>
                    </tbody>
                </table>
            </uib-tab>
        </uib-tabset>
    </div>
</div>
<div class="debug">
    <div class="list-item" ng-repeat="msg in msgStack track by $index">
        <pre>{{$index}} {{msg.event}} {{msg.parent}} {{msg.payload}}</pre>
    </div>
    <div class="btn" (click)="performSave()">Save</div>
</div>
<div ui-content-for="modals">
    <div class="modal" ui-if="modalMarkdownDialog" ui-state='modalMarkdownDialog'>
        <div class="modal-backdrop in"></div>
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button class="close"
                            ui-turn-off="modalMarkdownDialog">&times;</button>
                    <h4 class="modal-title">Markdown syntax</h4>
                </div>
                <div class="modal-body">
                    <div class="scrollable">
                        <div class="scrollable-content" ng-include="'/app/viewer/markdown.html'">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="modal" ui-if="iconDialog" ui-state='iconDialog'>
        <div class="modal-backdrop in" ui-turn-off="iconDialog"></div>
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button class="close" ui-turn-off="iconDialog">&times;</button>
                    <h4 class="modal-title">Add icon</h4>
                </div>
                <div class="modal-body" ng-controller="viewerIconDialogController">
                    <div id='iconSelectList' class="table">
                        <div class="iconSelectCell" ng-repeat="item in iconList"
                             ngClass="{'selected':$index==selectedIndex}"
                             uib-tooltip="{{item.description?item.description:item.name}} {{item.shortcut?'('+item.shortcut+')':''}}">
                            <img ng-src="{{item.link}}" (click)="addIcon(item.name)" ui-turn-off="iconDialog"/>
                        </div>
                    </div>
                    </div>
                <div class="modal-footer">
                    Alt-H for shortcuts
                </div>
            </div>
        </div>
    </div>
</div>
</div>